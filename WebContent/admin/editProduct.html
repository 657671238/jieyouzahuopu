<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Ela Admin - HTML5 Admin Template</title>
    <meta name="description" content="Ela Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    

    <link rel="stylesheet" href="assets/css/normalize.css">
	<link rel="stylesheet" href="assets/css/bootstrap.min.css">
	<link rel="stylesheet" href="assets/css/font-awesome.min.css">
	<link rel="stylesheet" href="assets/css/themify-icons.css">
	<link rel="stylesheet" href="assets/css/pe-icon-7-filled.css">
    <link rel="stylesheet" href="assets/css/flag-icon.min.css">
    <link rel="stylesheet" href="assets/css/cs-skin-elastic.css">
    <link rel="stylesheet" href="assets/css/style.css">
    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->

	<link href="assets/css/charts/chartist.min.css" rel="stylesheet">
	<link href="assets/css/lib/vector-map/jqvmap.min.css" rel="stylesheet">
	
	
	<link rel="stylesheet" href="../layui/css/layui.css"  media="all">

   <style>
   	#mycontent{
		background-color:white;
		width:90%;
		margin:0px auto;
	}
	#myform{
		width:400px;
	}

    </style>
</head>

<body>
    <!-- Left Panel -->
    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">
            <div id="main-menu" class="main-menu collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="menu-title">UI elements</li><!-- /.menu-title -->
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-cogs"></i>商品管理</a>
                        	<ul class="sub-menu children dropdown-menu">                            
	                        	<li><i class="fa fa-puzzle-piece"></i><a href="index.html">商品列表</a></li>
	                            <li><i class="fa fa-id-badge"></i><a href="addProduct.html">商品添加</a></li>
                        	</ul>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-table"></i>轮播管理</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="fa fa-table"></i><a href="lunbolist.html">轮播列表</a></li>
                            <li><i class="fa fa-table"></i><a href="addLunBo.html">添加轮播</a></li>
                        </ul>
                    </li>
                    <li>
                        <a href="remen.html"> <i class="menu-icon ti-email"></i>热门管理 </a>
                    </li>
                    <li>
                        <a href="edituser.html"> <i class="menu-icon fa fa-line-chart"></i>用户管理 </a>
                    </li>
                    <li class="menu-item-has-children dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> <i class="menu-icon fa fa-tasks"></i>订单管理</a>
                        <ul class="sub-menu children dropdown-menu">
                            <li><i class="menu-icon fa fa-fort-awesome"></i><a href="orders.html">订单列表</a></li>
                        </ul>
                    </li>
                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside>
    <!-- /#left-panel -->
    <!-- Right Panel -->
    <div id="right-panel" class="right-panel" style="height:100%">
        <!-- Header-->
        <header id="header" class="header">
            <div class="top-left">
                <div class="navbar-header">
                    <a class="navbar-brand" href="./"><img src="images/logo.png" alt="Logo"></a>
                    <a class="navbar-brand hidden" href="./"><img src="images/logo2.png" alt="Logo"></a>
                </div>
            </div>
            <div class="top-right">
                <div class="header-menu">

                    <div class="user-area dropdown float-right">
                        <a href="#" class="dropdown-toggle active" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img class="user-avatar rounded-circle" src="images/admin.jpg" alt="User Avatar">
                        </a>

                        <div class="user-menu dropdown-menu">
                            <a class="nav-link" href="#"><i class="fa fa- user"></i>My Profile</a>

                            <a class="nav-link" href="#"><i class="fa fa- user"></i>Notifications <span class="count">13</span></a>

                            <a class="nav-link" href="#"><i class="fa fa -cog"></i>Settings</a>

                            <a class="nav-link" href="#"><i class="fa fa-power -off"></i>Logout</a>
                        </div>
                    </div>

                </div>
            </div>
        </header>
        <!-- /#header -->
        <!-- Content -->
        <div class="pagecontent" style="min-height:580px;background-color:white;">
            <!-- 主体内容 -->
            <div class=".mynav" style="padding-left:50px;margin-bottom:20px;">
            	<h2>编辑商品</h2>
            </div>
            <div id="mycontent">
         	<div id="myform">
				<form action="../updateProductFile" method="post" enctype="multipart/form-data">
					<div class="form-group">
						<label for="pro_name">商品id:<span id="show_id"></span></label>
						<input type="hidden" id="pro_id" name="pro_id"
							class="form-control" required
							placeholder="输入商品名称">
					</div>
					<div class="form-group">
						<label for="pro_name">商品名称</label> <input type="text"
							class="form-control" id="pro_name" name="pro_name" required
							placeholder="输入商品名称">
					</div>
					<div class="form-group">
						<label for="pro_price">商品价格</label> 
						<input type="text"
							class="form-control" id="pro_price" name="pro_price" required
							placeholder="输入商品价格">
					</div>
					<div class="form-group">
						<label for="pro_price">添加日期</label> 
						<input
							type="datetime-local" name="pro_create" class="form-control" required
							id="pro_create">
					</div>
					<div class="form-group">
						<label for="pro_desc">商品描述</label><br>
						<textarea id="pro_desc" name="pro_desc" required rows="5" cols="10"></textarea>
					</div>
					<div class="form-group">
						<label for="pro_image">要修改的图片:</label><br>
						<img id="pro_image" style="width:180px" />
						<input type="hidden" id="original_image" name="pro_image">
					</div>
					<div class="form-group">
						<label for="pro_image">点击上传新的图片:</label><br>
						<input type="file" accept=".jpg,.png,.jpeg,.gif" name="upload" id="uploadFile" onchange="loadImage()"/>
					</div>
					<button type="submit" id="btnSubmit" class="btn btn-default">提交</button>
				</form>
			</div>
           </div>
        </div>
        <!-- /.content -->
        <div class="clearfix"></div>
    </div>
    
    <!-- /#right-panel -->

<script src="../js/jquery-2.2.4.min.js"></script>
<script src="assets/js/popper.min.js"></script>
<script src="assets/js/plugins.js"></script>
<script src="assets/js/main.js"></script>

<script src="assets/js/lib/chartist/chartist.min.js"></script>
<script src="assets/js/lib/chartist/chartist-plugin-legend.js"></script>
<script src="assets/js/lib/flot-chart/jquery.flot.js"></script>
<script src="assets/js/lib/flot-chart/jquery.flot.pie.js"></script>
<script src="assets/js/lib/flot-chart/jquery.flot.spline.js"></script>
<script src="assets/weather/js/jquery.simpleWeather.min.js"></script>
<script src="assets/weather/js/weather-init.js"></script>


<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@3.9.0/dist/fullcalendar.min.js"></script>
<script src="assets/js/init/fullcalendar-init.js"></script>

<script src="../js/jquery-2.2.4.min.js"></script>

<script src="../js/layer.js" charset="utf-8"></script>
<script src="../js/mylayer.js" charset="utf-8"></script>


<script>
//当file控件  选中一张图片的时候  就会触发这个方法  这个方法可以将上面的图片换掉
var oldImage = null;
function loadImage(){
	//get(0) 是将JQuery对象  转换为DOM对象
	//document.getElementById("uploadFile");
	var upload = $("#uploadFile").get(0);
	console.dir(upload);
	//表示至少选中了一张图片信息
	if(upload.files.length>0){
		var file = upload.files[0];
		var read = new FileReader();
		read.readAsDataURL(file);
		read.onloadend = function(){
			$("#pro_image").attr("src",read.result);	
		}
	}else{
		console.log("用户没有选中图片")
		$("#pro_image").attr("src",oldImage);
	}
}

jQuery(function($) {
	var pro_id = mylayer.getQueryString("pro_id");
	console.log(pro_id);
	//发送Ajax请求  获取数据填充到界面
	$.ajax({
		type:"GET",
		url:"../queryProductByIdJSON",
		data:"pro_id="+pro_id,
		dataType:"json",
		success:function(data){
			console.log(data);
			if(data.retcode==="0"){
				$("#pro_id").val(data.data.pro_id);
				$("#show_id").html(data.data.pro_id);
				$("#pro_name").val(data.data.pro_name);
				$("#pro_price").val(data.data.pro_price);
				$("#original_image").val(data.data.pro_image);
				$("#pro_desc").val(data.data.pro_desc);
				$("#pro_image").attr("src","../images/"+data.data.pro_image);
				var tempTime = data.data.pro_create;
				var resultTime = tempTime.substring(0,tempTime.length-3);
				//时间格式可以  前台修改  也可以后台修改 时间格式
				resultTime = resultTime.replace(" ","T");
				//console.log(resultTime);
				$("#pro_create").val(resultTime);
				
				oldImage = "../images/"+data.data.pro_image;
			}else {
				mylayer.showError("商品信息不存在");
			}
		},
		error:function(xhr,status,error){
			mylayer.showError(status);
		}
	});
});
</script>
</body>
</html>
